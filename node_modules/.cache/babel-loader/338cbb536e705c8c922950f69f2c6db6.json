{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _KeyCode = require('rc-util/lib/KeyCode');\n\nvar _KeyCode2 = _interopRequireDefault(_KeyCode);\n\nvar _reactLifecyclesCompat = require('react-lifecycles-compat');\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _util = require('../util');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nvar cachedSelectionStart = void 0;\nvar cachedSelectionEnd = void 0;\nvar dateInputInstance = void 0;\n\nvar DateInput = function (_React$Component) {\n  (0, _inherits3['default'])(DateInput, _React$Component);\n\n  function DateInput(props) {\n    (0, _classCallCheck3['default'])(this, DateInput);\n\n    var _this = (0, _possibleConstructorReturn3['default'])(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var selectedValue = props.selectedValue;\n    _this.state = {\n      str: (0, _util.formatDate)(selectedValue, _this.props.format),\n      invalid: false,\n      hasFocus: false\n    };\n    return _this;\n  }\n\n  DateInput.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (dateInputInstance && this.state.hasFocus && !this.state.invalid && !(cachedSelectionStart === 0 && cachedSelectionEnd === 0)) {\n      dateInputInstance.setSelectionRange(cachedSelectionStart, cachedSelectionEnd);\n    }\n  };\n\n  DateInput.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, state) {\n    var newState = {};\n\n    if (dateInputInstance) {\n      cachedSelectionStart = dateInputInstance.selectionStart;\n      cachedSelectionEnd = dateInputInstance.selectionEnd;\n    } // when popup show, click body will call this, bug!\n\n\n    var selectedValue = nextProps.selectedValue;\n\n    if (!state.hasFocus) {\n      newState = {\n        str: (0, _util.formatDate)(selectedValue, nextProps.format),\n        invalid: false\n      };\n    }\n\n    return newState;\n  };\n\n  DateInput.getInstance = function getInstance() {\n    return dateInputInstance;\n  };\n\n  DateInput.prototype.render = function render() {\n    var props = this.props;\n    var _state = this.state,\n        invalid = _state.invalid,\n        str = _state.str;\n    var locale = props.locale,\n        prefixCls = props.prefixCls,\n        placeholder = props.placeholder,\n        clearIcon = props.clearIcon,\n        inputMode = props.inputMode;\n    var invalidClass = invalid ? prefixCls + '-input-invalid' : '';\n    return _react2['default'].createElement('div', {\n      className: prefixCls + '-input-wrap'\n    }, _react2['default'].createElement('div', {\n      className: prefixCls + '-date-input-wrap'\n    }, _react2['default'].createElement('input', {\n      ref: this.saveDateInput,\n      className: prefixCls + '-input ' + invalidClass,\n      value: str,\n      disabled: props.disabled,\n      placeholder: placeholder,\n      onChange: this.onInputChange,\n      onKeyDown: this.onKeyDown,\n      onFocus: this.onFocus,\n      onBlur: this.onBlur,\n      inputMode: inputMode\n    })), props.showClear ? _react2['default'].createElement('a', {\n      role: 'button',\n      title: locale.clear,\n      onClick: this.onClear\n    }, clearIcon || _react2['default'].createElement('span', {\n      className: prefixCls + '-clear-btn'\n    })) : null);\n  };\n\n  return DateInput;\n}(_react2['default'].Component);\n\nDateInput.propTypes = {\n  prefixCls: _propTypes2['default'].string,\n  timePicker: _propTypes2['default'].object,\n  value: _propTypes2['default'].object,\n  disabledTime: _propTypes2['default'].any,\n  format: _propTypes2['default'].oneOfType([_propTypes2['default'].string, _propTypes2['default'].arrayOf(_propTypes2['default'].string)]),\n  locale: _propTypes2['default'].object,\n  disabledDate: _propTypes2['default'].func,\n  onChange: _propTypes2['default'].func,\n  onClear: _propTypes2['default'].func,\n  placeholder: _propTypes2['default'].string,\n  onSelect: _propTypes2['default'].func,\n  selectedValue: _propTypes2['default'].object,\n  clearIcon: _propTypes2['default'].node,\n  inputMode: _propTypes2['default'].string\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onClear = function () {\n    _this2.setState({\n      str: ''\n    });\n\n    _this2.props.onClear(null);\n  };\n\n  this.onInputChange = function (event) {\n    var str = event.target.value;\n    var _props = _this2.props,\n        disabledDate = _props.disabledDate,\n        format = _props.format,\n        onChange = _props.onChange,\n        selectedValue = _props.selectedValue; // 没有内容，合法并直接退出\n\n    if (!str) {\n      onChange(null);\n\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n\n      return;\n    } // 不合法直接退出\n\n\n    var parsed = (0, _moment2['default'])(str, format, true);\n\n    if (!parsed.isValid()) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n\n      return;\n    }\n\n    var value = _this2.props.value.clone();\n\n    value.year(parsed.year()).month(parsed.month()).date(parsed.date()).hour(parsed.hour()).minute(parsed.minute()).second(parsed.second());\n\n    if (!value || disabledDate && disabledDate(value)) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n\n      return;\n    }\n\n    if (selectedValue !== value || selectedValue && value && !selectedValue.isSame(value)) {\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n\n      onChange(value);\n    }\n  };\n\n  this.onFocus = function () {\n    _this2.setState({\n      hasFocus: true\n    });\n  };\n\n  this.onBlur = function () {\n    _this2.setState(function (prevState, prevProps) {\n      return {\n        hasFocus: false,\n        str: (0, _util.formatDate)(prevProps.value, prevProps.format)\n      };\n    });\n  };\n\n  this.onKeyDown = function (event) {\n    var keyCode = event.keyCode;\n    var _props2 = _this2.props,\n        onSelect = _props2.onSelect,\n        value = _props2.value,\n        disabledDate = _props2.disabledDate;\n\n    if (keyCode === _KeyCode2['default'].ENTER && onSelect) {\n      var validateDate = !disabledDate || !disabledDate(value);\n\n      if (validateDate) {\n        onSelect(value.clone());\n      }\n\n      event.preventDefault();\n    }\n  };\n\n  this.getRootDOMNode = function () {\n    return _reactDom2['default'].findDOMNode(_this2);\n  };\n\n  this.focus = function () {\n    if (dateInputInstance) {\n      dateInputInstance.focus();\n    }\n  };\n\n  this.saveDateInput = function (dateInput) {\n    dateInputInstance = dateInput;\n  };\n};\n\n(0, _reactLifecyclesCompat.polyfill)(DateInput);\nexports['default'] = DateInput;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["/Users/salonibhogale/qhsearchui/node_modules/rc-calendar/lib/date/DateInput.js"],"names":["exports","__esModule","_classCallCheck2","require","_classCallCheck3","_interopRequireDefault","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_reactDom","_reactDom2","_propTypes","_propTypes2","_KeyCode","_KeyCode2","_reactLifecyclesCompat","_moment","_moment2","_util","obj","cachedSelectionStart","cachedSelectionEnd","dateInputInstance","DateInput","_React$Component","props","_this","call","_initialiseProps","selectedValue","state","str","formatDate","format","invalid","hasFocus","prototype","componentDidUpdate","setSelectionRange","getDerivedStateFromProps","nextProps","newState","selectionStart","selectionEnd","getInstance","render","_state","locale","prefixCls","placeholder","clearIcon","inputMode","invalidClass","createElement","className","ref","saveDateInput","value","disabled","onChange","onInputChange","onKeyDown","onFocus","onBlur","showClear","role","title","clear","onClick","onClear","Component","propTypes","string","timePicker","object","disabledTime","any","oneOfType","arrayOf","disabledDate","func","onSelect","node","_this2","setState","event","target","_props","parsed","isValid","clone","year","month","date","hour","minute","second","isSame","prevState","prevProps","keyCode","_props2","ENTER","validateDate","preventDefault","getRootDOMNode","findDOMNode","focus","dateInput","polyfill","module"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _KeyCode = require('rc-util/lib/KeyCode');\n\nvar _KeyCode2 = _interopRequireDefault(_KeyCode);\n\nvar _reactLifecyclesCompat = require('react-lifecycles-compat');\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _util = require('../util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar cachedSelectionStart = void 0;\nvar cachedSelectionEnd = void 0;\nvar dateInputInstance = void 0;\n\nvar DateInput = function (_React$Component) {\n  (0, _inherits3['default'])(DateInput, _React$Component);\n\n  function DateInput(props) {\n    (0, _classCallCheck3['default'])(this, DateInput);\n\n    var _this = (0, _possibleConstructorReturn3['default'])(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var selectedValue = props.selectedValue;\n\n    _this.state = {\n      str: (0, _util.formatDate)(selectedValue, _this.props.format),\n      invalid: false,\n      hasFocus: false\n    };\n    return _this;\n  }\n\n  DateInput.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (dateInputInstance && this.state.hasFocus && !this.state.invalid && !(cachedSelectionStart === 0 && cachedSelectionEnd === 0)) {\n      dateInputInstance.setSelectionRange(cachedSelectionStart, cachedSelectionEnd);\n    }\n  };\n\n  DateInput.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, state) {\n    var newState = {};\n\n    if (dateInputInstance) {\n      cachedSelectionStart = dateInputInstance.selectionStart;\n      cachedSelectionEnd = dateInputInstance.selectionEnd;\n    }\n    // when popup show, click body will call this, bug!\n    var selectedValue = nextProps.selectedValue;\n    if (!state.hasFocus) {\n      newState = {\n        str: (0, _util.formatDate)(selectedValue, nextProps.format),\n        invalid: false\n      };\n    }\n\n    return newState;\n  };\n\n  DateInput.getInstance = function getInstance() {\n    return dateInputInstance;\n  };\n\n  DateInput.prototype.render = function render() {\n    var props = this.props;\n    var _state = this.state,\n        invalid = _state.invalid,\n        str = _state.str;\n    var locale = props.locale,\n        prefixCls = props.prefixCls,\n        placeholder = props.placeholder,\n        clearIcon = props.clearIcon,\n        inputMode = props.inputMode;\n\n    var invalidClass = invalid ? prefixCls + '-input-invalid' : '';\n    return _react2['default'].createElement(\n      'div',\n      { className: prefixCls + '-input-wrap' },\n      _react2['default'].createElement(\n        'div',\n        { className: prefixCls + '-date-input-wrap' },\n        _react2['default'].createElement('input', {\n          ref: this.saveDateInput,\n          className: prefixCls + '-input ' + invalidClass,\n          value: str,\n          disabled: props.disabled,\n          placeholder: placeholder,\n          onChange: this.onInputChange,\n          onKeyDown: this.onKeyDown,\n          onFocus: this.onFocus,\n          onBlur: this.onBlur,\n          inputMode: inputMode\n        })\n      ),\n      props.showClear ? _react2['default'].createElement(\n        'a',\n        {\n          role: 'button',\n          title: locale.clear,\n          onClick: this.onClear\n        },\n        clearIcon || _react2['default'].createElement('span', { className: prefixCls + '-clear-btn' })\n      ) : null\n    );\n  };\n\n  return DateInput;\n}(_react2['default'].Component);\n\nDateInput.propTypes = {\n  prefixCls: _propTypes2['default'].string,\n  timePicker: _propTypes2['default'].object,\n  value: _propTypes2['default'].object,\n  disabledTime: _propTypes2['default'].any,\n  format: _propTypes2['default'].oneOfType([_propTypes2['default'].string, _propTypes2['default'].arrayOf(_propTypes2['default'].string)]),\n  locale: _propTypes2['default'].object,\n  disabledDate: _propTypes2['default'].func,\n  onChange: _propTypes2['default'].func,\n  onClear: _propTypes2['default'].func,\n  placeholder: _propTypes2['default'].string,\n  onSelect: _propTypes2['default'].func,\n  selectedValue: _propTypes2['default'].object,\n  clearIcon: _propTypes2['default'].node,\n  inputMode: _propTypes2['default'].string\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onClear = function () {\n    _this2.setState({\n      str: ''\n    });\n    _this2.props.onClear(null);\n  };\n\n  this.onInputChange = function (event) {\n    var str = event.target.value;\n    var _props = _this2.props,\n        disabledDate = _props.disabledDate,\n        format = _props.format,\n        onChange = _props.onChange,\n        selectedValue = _props.selectedValue;\n\n    // 没有内容，合法并直接退出\n\n    if (!str) {\n      onChange(null);\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n      return;\n    }\n\n    // 不合法直接退出\n    var parsed = (0, _moment2['default'])(str, format, true);\n    if (!parsed.isValid()) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n      return;\n    }\n\n    var value = _this2.props.value.clone();\n    value.year(parsed.year()).month(parsed.month()).date(parsed.date()).hour(parsed.hour()).minute(parsed.minute()).second(parsed.second());\n\n    if (!value || disabledDate && disabledDate(value)) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n      return;\n    }\n\n    if (selectedValue !== value || selectedValue && value && !selectedValue.isSame(value)) {\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n      onChange(value);\n    }\n  };\n\n  this.onFocus = function () {\n    _this2.setState({ hasFocus: true });\n  };\n\n  this.onBlur = function () {\n    _this2.setState(function (prevState, prevProps) {\n      return {\n        hasFocus: false,\n        str: (0, _util.formatDate)(prevProps.value, prevProps.format)\n      };\n    });\n  };\n\n  this.onKeyDown = function (event) {\n    var keyCode = event.keyCode;\n    var _props2 = _this2.props,\n        onSelect = _props2.onSelect,\n        value = _props2.value,\n        disabledDate = _props2.disabledDate;\n\n    if (keyCode === _KeyCode2['default'].ENTER && onSelect) {\n      var validateDate = !disabledDate || !disabledDate(value);\n      if (validateDate) {\n        onSelect(value.clone());\n      }\n      event.preventDefault();\n    }\n  };\n\n  this.getRootDOMNode = function () {\n    return _reactDom2['default'].findDOMNode(_this2);\n  };\n\n  this.focus = function () {\n    if (dateInputInstance) {\n      dateInputInstance.focus();\n    }\n  };\n\n  this.saveDateInput = function (dateInput) {\n    dateInputInstance = dateInput;\n  };\n};\n\n(0, _reactLifecyclesCompat.polyfill)(DateInput);\n\nexports['default'] = DateInput;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}