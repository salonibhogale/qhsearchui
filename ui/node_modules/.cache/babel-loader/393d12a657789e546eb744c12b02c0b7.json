{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar PropTypes = require(\"prop-types\");\n\nvar core_1 = require(\"../../../../core\");\n\nvar SearchBox_1 = require(\"../../search-box/SearchBox\");\n\nvar ui_1 = require(\"../../../ui\");\n\nvar defaults = require('lodash/defaults');\n\nvar throttle = require('lodash/throttle');\n\nvar assign = require('lodash/assign');\n\nvar isUndefined = require('lodash/isUndefined');\n\nvar InputFilter =\n/** @class */\nfunction (_super) {\n  __extends(InputFilter, _super);\n\n  function InputFilter(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.translations = SearchBox_1.SearchBox.translations;\n    _this.state = {\n      focused: false,\n      input: undefined\n    };\n    _this.lastSearchMs = 0;\n    _this.onClear = _this.onClear.bind(_this);\n    _this.throttledSearch = throttle(function () {\n      _this.searchQuery(_this.accessor.getQueryString());\n    }, props.searchThrottleTime);\n    return _this;\n  }\n\n  InputFilter.prototype.componentDidMount = function () {\n    _super.prototype.componentDidMount.call(this);\n  };\n\n  InputFilter.prototype.defineBEMBlocks = function () {\n    return {\n      container: this.props.mod\n    };\n  };\n\n  InputFilter.prototype.defineAccessor = function () {\n    var _this = this;\n\n    var _a = this.props,\n        id = _a.id,\n        title = _a.title,\n        prefixQueryFields = _a.prefixQueryFields,\n        queryFields = _a.queryFields,\n        queryBuilder = _a.queryBuilder,\n        queryOptions = _a.queryOptions,\n        prefixQueryOptions = _a.prefixQueryOptions;\n    return new core_1.QueryAccessor(id, {\n      title: title,\n      addToFilters: true,\n      queryFields: queryFields || ['_all'],\n      prefixQueryFields: prefixQueryFields,\n      queryOptions: assign({}, queryOptions),\n      prefixQueryOptions: assign({}, prefixQueryOptions),\n      queryBuilder: queryBuilder,\n      onQueryStateChange: function () {\n        if (!_this.unmounted && _this.state.input) {\n          _this.setState({\n            input: undefined\n          });\n        }\n      }\n    });\n  };\n\n  InputFilter.prototype.onSubmit = function (event) {\n    event.preventDefault();\n    this.searchQuery(this.getValue());\n  };\n\n  InputFilter.prototype.searchQuery = function (query) {\n    var shouldResetOtherState = false;\n    this.accessor.setQueryString(query, shouldResetOtherState);\n    var now = +new Date();\n    var newSearch = now - this.lastSearchMs <= 2000;\n    this.lastSearchMs = now;\n    this.searchkit.performSearch(newSearch);\n  };\n\n  InputFilter.prototype.getValue = function () {\n    var input = this.state.input;\n\n    if (isUndefined(input)) {\n      return this.getAccessorValue();\n    }\n\n    return input;\n  };\n\n  InputFilter.prototype.getAccessorValue = function () {\n    return (this.accessor.state.getValue() || '') + '';\n  };\n\n  InputFilter.prototype.onChange = function (e) {\n    var query = e.target.value;\n\n    if (this.props.searchOnChange) {\n      this.accessor.setQueryString(query);\n      this.throttledSearch();\n      this.forceUpdate();\n    } else {\n      this.setState({\n        input: query\n      });\n    }\n  };\n\n  InputFilter.prototype.onClear = function () {\n    this.accessor.state = this.accessor.state.clear();\n    this.searchkit.performSearch();\n    this.setState({\n      input: undefined\n    });\n  };\n\n  InputFilter.prototype.setFocusState = function (focused) {\n    if (!focused) {\n      var input = this.state.input;\n\n      if (this.props.blurAction == 'search' && !isUndefined(input) && input != this.getAccessorValue()) {\n        this.searchQuery(input);\n      }\n\n      this.setState({\n        focused: focused,\n        input: undefined // Flush (should use accessor's state now)\n\n      });\n    } else {\n      this.setState({\n        focused: focused\n      });\n    }\n  };\n\n  InputFilter.prototype.render = function () {\n    if (!this.accessor) return null;\n    var _a = this.props,\n        containerComponent = _a.containerComponent,\n        title = _a.title,\n        id = _a.id;\n    var block = this.bemBlocks.container;\n    var value = this.getValue();\n    return core_1.renderComponent(containerComponent, {\n      title: title,\n      className: id ? \"filter--\" + id : undefined,\n      disabled: this.searchkit.getHitsCount() == 0 && this.getAccessorValue() == ''\n    }, React.createElement(\"div\", {\n      className: block().state({\n        focused: this.state.focused\n      })\n    }, React.createElement(\"form\", {\n      onSubmit: this.onSubmit.bind(this)\n    }, React.createElement(\"div\", {\n      className: block('icon')\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      \"data-qa\": \"input-filter\",\n      className: block('text'),\n      placeholder: this.props.placeholder || this.translate('searchbox.placeholder'),\n      value: value,\n      onFocus: this.setFocusState.bind(this, true),\n      onBlur: this.setFocusState.bind(this, false),\n      ref: \"queryField\",\n      autoFocus: false,\n      onChange: this.onChange.bind(this)\n    }), React.createElement(\"input\", {\n      type: \"submit\",\n      value: this.translate('searchbox.button'),\n      className: block('action'),\n      \"data-qa\": \"submit\"\n    }), React.createElement(\"div\", {\n      \"data-qa\": \"remove\",\n      onClick: this.onClear,\n      className: block('remove').state({\n        hidden: value == ''\n      })\n    }))));\n  };\n\n  InputFilter.translations = {\n    'searchbox.placeholder': 'Search',\n    'searchbox.button': 'search'\n  };\n  InputFilter.defaultProps = {\n    containerComponent: ui_1.Panel,\n    collapsable: false,\n    mod: 'sk-input-filter',\n    searchThrottleTime: 200,\n    blurAction: 'search'\n  };\n  InputFilter.propTypes = defaults({\n    id: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    searchOnChange: PropTypes.bool,\n    searchThrottleTime: PropTypes.number,\n    queryBuilder: PropTypes.func,\n    queryFields: PropTypes.arrayOf(PropTypes.string),\n    queryOptions: PropTypes.object,\n    prefixQueryFields: PropTypes.arrayOf(PropTypes.string),\n    prefixQueryOptions: PropTypes.object,\n    translations: core_1.SearchkitComponent.translationsPropType(SearchBox_1.SearchBox.translations),\n    mod: PropTypes.string,\n    placeholder: PropTypes.string,\n    blurAction: PropTypes.string\n  }, core_1.SearchkitComponent.propTypes);\n  return InputFilter;\n}(core_1.SearchkitComponent);\n\nexports.InputFilter = InputFilter;","map":{"version":3,"sources":["../../../../../src/components/search/filters/input-filter/InputFilter.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar PropTypes = require(\"prop-types\");\nvar core_1 = require(\"../../../../core\");\nvar SearchBox_1 = require(\"../../search-box/SearchBox\");\nvar ui_1 = require(\"../../../ui\");\nvar defaults = require('lodash/defaults');\nvar throttle = require('lodash/throttle');\nvar assign = require('lodash/assign');\nvar isUndefined = require('lodash/isUndefined');\nvar InputFilter = /** @class */ (function (_super) {\n    __extends(InputFilter, _super);\n    function InputFilter(props) {\n        var _this = _super.call(this, props) || this;\n        _this.translations = SearchBox_1.SearchBox.translations;\n        _this.state = {\n            focused: false,\n            input: undefined\n        };\n        _this.lastSearchMs = 0;\n        _this.onClear = _this.onClear.bind(_this);\n        _this.throttledSearch = throttle(function () {\n            _this.searchQuery(_this.accessor.getQueryString());\n        }, props.searchThrottleTime);\n        return _this;\n    }\n    InputFilter.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n    };\n    InputFilter.prototype.defineBEMBlocks = function () {\n        return { container: this.props.mod };\n    };\n    InputFilter.prototype.defineAccessor = function () {\n        var _this = this;\n        var _a = this.props, id = _a.id, title = _a.title, prefixQueryFields = _a.prefixQueryFields, queryFields = _a.queryFields, queryBuilder = _a.queryBuilder, queryOptions = _a.queryOptions, prefixQueryOptions = _a.prefixQueryOptions;\n        return new core_1.QueryAccessor(id, {\n            title: title,\n            addToFilters: true,\n            queryFields: queryFields || ['_all'],\n            prefixQueryFields: prefixQueryFields,\n            queryOptions: assign({}, queryOptions),\n            prefixQueryOptions: assign({}, prefixQueryOptions),\n            queryBuilder: queryBuilder,\n            onQueryStateChange: function () {\n                if (!_this.unmounted && _this.state.input) {\n                    _this.setState({ input: undefined });\n                }\n            }\n        });\n    };\n    InputFilter.prototype.onSubmit = function (event) {\n        event.preventDefault();\n        this.searchQuery(this.getValue());\n    };\n    InputFilter.prototype.searchQuery = function (query) {\n        var shouldResetOtherState = false;\n        this.accessor.setQueryString(query, shouldResetOtherState);\n        var now = +new Date();\n        var newSearch = now - this.lastSearchMs <= 2000;\n        this.lastSearchMs = now;\n        this.searchkit.performSearch(newSearch);\n    };\n    InputFilter.prototype.getValue = function () {\n        var input = this.state.input;\n        if (isUndefined(input)) {\n            return this.getAccessorValue();\n        }\n        return input;\n    };\n    InputFilter.prototype.getAccessorValue = function () {\n        return (this.accessor.state.getValue() || '') + '';\n    };\n    InputFilter.prototype.onChange = function (e) {\n        var query = e.target.value;\n        if (this.props.searchOnChange) {\n            this.accessor.setQueryString(query);\n            this.throttledSearch();\n            this.forceUpdate();\n        }\n        else {\n            this.setState({ input: query });\n        }\n    };\n    InputFilter.prototype.onClear = function () {\n        this.accessor.state = this.accessor.state.clear();\n        this.searchkit.performSearch();\n        this.setState({ input: undefined });\n    };\n    InputFilter.prototype.setFocusState = function (focused) {\n        if (!focused) {\n            var input = this.state.input;\n            if (this.props.blurAction == 'search' &&\n                !isUndefined(input) &&\n                input != this.getAccessorValue()) {\n                this.searchQuery(input);\n            }\n            this.setState({\n                focused: focused,\n                input: undefined // Flush (should use accessor's state now)\n            });\n        }\n        else {\n            this.setState({ focused: focused });\n        }\n    };\n    InputFilter.prototype.render = function () {\n        if (!this.accessor)\n            return null;\n        var _a = this.props, containerComponent = _a.containerComponent, title = _a.title, id = _a.id;\n        var block = this.bemBlocks.container;\n        var value = this.getValue();\n        return core_1.renderComponent(containerComponent, {\n            title: title,\n            className: id ? \"filter--\" + id : undefined,\n            disabled: this.searchkit.getHitsCount() == 0 && this.getAccessorValue() == ''\n        }, React.createElement(\"div\", { className: block().state({ focused: this.state.focused }) },\n            React.createElement(\"form\", { onSubmit: this.onSubmit.bind(this) },\n                React.createElement(\"div\", { className: block('icon') }),\n                React.createElement(\"input\", { type: \"text\", \"data-qa\": \"input-filter\", className: block('text'), placeholder: this.props.placeholder || this.translate('searchbox.placeholder'), value: value, onFocus: this.setFocusState.bind(this, true), onBlur: this.setFocusState.bind(this, false), ref: \"queryField\", autoFocus: false, onChange: this.onChange.bind(this) }),\n                React.createElement(\"input\", { type: \"submit\", value: this.translate('searchbox.button'), className: block('action'), \"data-qa\": \"submit\" }),\n                React.createElement(\"div\", { \"data-qa\": \"remove\", onClick: this.onClear, className: block('remove').state({ hidden: value == '' }) }))));\n    };\n    InputFilter.translations = {\n        'searchbox.placeholder': 'Search',\n        'searchbox.button': 'search'\n    };\n    InputFilter.defaultProps = {\n        containerComponent: ui_1.Panel,\n        collapsable: false,\n        mod: 'sk-input-filter',\n        searchThrottleTime: 200,\n        blurAction: 'search'\n    };\n    InputFilter.propTypes = defaults({\n        id: PropTypes.string.isRequired,\n        title: PropTypes.string.isRequired,\n        searchOnChange: PropTypes.bool,\n        searchThrottleTime: PropTypes.number,\n        queryBuilder: PropTypes.func,\n        queryFields: PropTypes.arrayOf(PropTypes.string),\n        queryOptions: PropTypes.object,\n        prefixQueryFields: PropTypes.arrayOf(PropTypes.string),\n        prefixQueryOptions: PropTypes.object,\n        translations: core_1.SearchkitComponent.translationsPropType(SearchBox_1.SearchBox.translations),\n        mod: PropTypes.string,\n        placeholder: PropTypes.string,\n        blurAction: PropTypes.string\n    }, core_1.SearchkitComponent.propTypes);\n    return InputFilter;\n}(core_1.SearchkitComponent));\nexports.InputFilter = InputFilter;\n//# sourceMappingURL=InputFilter.js.map"]},"metadata":{},"sourceType":"script"}